<!DOCTYPE html>
<html lang="en">

<head>

<!-- css -->
<link rel="stylesheet" href="/static/css/jquery.timepicker.css">
<link rel="stylesheet" href="/static/css/theme.css">

<!-- js -->
<script type="text/javascript" src="/static/js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.timepicker.js"></script>
<script type="text/javascript" src="/static/js/theme.js"></script>

</head>

<body>

    <title>Alarm/Timer</title>

    <script type="text/javascript">
     function wsInit() {

        var ws = new WebSocket("ws://127.0.0.1:5000/ws");

        ws.onmessage = function (evt) {
          console.log(evt.data);
          if(evt.data != "alarm") {
             var ta = document.getElementById("ta");
             var ti = evt.data.replace(/['"]+/g, '');
             ta.value = ti
           }
          if(evt.data == "alarm") {
             playTone()
           }
        };

      }
    </script>

    <script type="text/javascript">
    function alarmSub() {
      var ws = new WebSocket("ws://127.0.0.1:5000/ws");
      ws.onopen = function() {
        var input = document.getElementById("alarm-value");
        ws.send(input.value);
        };

      ws.onmessage = function (evt) {
        console.log(evt.data);
        if(evt.data == "alarm") {
           playTone()
         }
      };
      };
    </script>


    <script type="text/javascript">
        wsInit()
    </script>
    <div class="time-container">
      <textarea readonly="readonly" unselectable="on" id="ta"></textarea>
    </div>

    <div class="alarm">
      <input type="text" id="alarm-value" name="timepicker" class="timepicker"/>
      <input type="button" value="Set Alarm" onclick="alarmSub()" class="alarmsubmit">
    </div>

    <script>
    $('.timepicker').timepicker({
        timeFormat: 'HH:mm:ss',
        defaultTime: 'now',
        dynamic: false,
        dropdown: false,
        scrollbar: false
    });
    </script>

</body>

</html>
