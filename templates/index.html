<!DOCTYPE html>
<html lang="en">

<head>

<!-- css -->
<link rel="stylesheet" href="/static/css/theme.css">

<!-- js -->
<script type="text/javascript" src="/static/js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="/static/js/theme.js"></script>

</head>

<body>

    <title>pomotime</title>


    <div class="title-container">
      <p>Pomodoro Timer</p>
    </div>

    <script type="text/javascript">
     function wsInit() {

        var ws = new WebSocket("ws://127.0.0.1:5000/ws");

        ws.onmessage = function (evt) {
          console.log(evt.data);
          if(evt.data != "alarm") {
             var ta = document.getElementById("ta");
             var ti = evt.data.replace(/['"]+/g, '');
             ta.value = ti
           }
         };
        }

    </script>

    <script type="text/javascript">
    function alarmSub() {
      var ws = new WebSocket("ws://127.0.0.1:5000/ws");

      ws.onopen = function() {
        var v = "start-timer"
        ws.send(v);
        };

      ws.onmessage = function (evt) {
        console.log(evt.data);

        if(evt.data != "alarm") {
           var ta = document.getElementById("ta");
           var ti = evt.data.replace(/['"]+/g, '');
           ta.value = ti
         }

        if(evt.data == "alarm") {
           playTone()
         }
       };
      };
    </script>

    <script type="text/javascript">
    function alarmStop() {
      var ws = new WebSocket("ws://127.0.0.1:5000/ws");

      ws.onopen = function() {
        var v = "stop-timer"
        ws.send(v);
        };
      };
    </script>

    <script type="text/javascript">
    function alarmReset() {
      var ws = new WebSocket("ws://127.0.0.1:5000/ws");

      ws.onopen = function() {
        var v = "reset-timer"
        ws.send(v);
        };
      };
    </script>


    <script type="text/javascript">
        wsInit()
    </script>

    <div class="time-container">
      <textarea readonly="readonly" unselectable="on" id="ta"></textarea>
    </div>

    <div class="alarm">
      <input type="button" value="Start" onclick="alarmSub()" class="alarmsubmit">
      <div class="space"></div>
      <input type="button" value="Stop" onclick="alarmStop()" class="alarmsubmit">
      <div class="space"></div>
      <input type="button" value="Reset" onclick="alarmReset()" class="alarmsubmit">
    </div>

</body>

</html>
